#
# Autogenerated by Thrift Compiler (0.10.0)
#
# DO NOT EDIT UNLESS YOU ARE SURE THAT YOU KNOW WHAT YOU ARE DOING
#

require 'thrift'
require 'radar/api/transaction_file_importer_types'

module Radar
  module Api
    module TransactionFileImporter
      class Client
        include ::Thrift::Client

        def extract(data)
          send_extract(data)
          return recv_extract()
        end

        def send_extract(data)
          send_message('extract', Extract_args, :data => data)
        end

        def recv_extract()
          result = receive_message(Extract_result)
          return result.success unless result.success.nil?
          raise result.col_quantity_error unless result.col_quantity_error.nil?
          raise ::Thrift::ApplicationException.new(::Thrift::ApplicationException::MISSING_RESULT, 'extract failed: unknown result')
        end

      end

      class Processor
        include ::Thrift::Processor

        def process_extract(seqid, iprot, oprot)
          args = read_args(iprot, Extract_args)
          result = Extract_result.new()
          begin
            result.success = @handler.extract(args.data)
          rescue ::Radar::Api::WrongFileStructure => col_quantity_error
            result.col_quantity_error = col_quantity_error
          end
          write_result(result, oprot, 'extract', seqid)
        end

      end

      # HELPER FUNCTIONS AND STRUCTURES

      class Extract_args
        include ::Thrift::Struct, ::Thrift::Struct_Union
        DATA = 1

        FIELDS = {
          DATA => {:type => ::Thrift::Types::STRING, :name => 'data'}
        }

        def struct_fields; FIELDS; end

        def validate
        end

        ::Thrift::Struct.generate_accessors self
      end

      class Extract_result
        include ::Thrift::Struct, ::Thrift::Struct_Union
        SUCCESS = 0
        COL_QUANTITY_ERROR = 1

        FIELDS = {
          SUCCESS => {:type => ::Thrift::Types::LIST, :name => 'success', :element => {:type => ::Thrift::Types::STRUCT, :class => ::Radar::Api::Transaction}},
          COL_QUANTITY_ERROR => {:type => ::Thrift::Types::STRUCT, :name => 'col_quantity_error', :class => ::Radar::Api::WrongFileStructure}
        }

        def struct_fields; FIELDS; end

        def validate
        end

        ::Thrift::Struct.generate_accessors self
      end

    end

  end
end
